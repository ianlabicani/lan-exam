<ion-content class="ion-padding">
  <div style="display: flex; justify-content: center; align-items: center; min-height: 100vh;">
    <ion-card style="width: 100%; max-width: 400px;">
      <ion-card-header>
        <ion-card-title class="ion-text-center ion-padding">
          Welcome Back
        </ion-card-title>
      </ion-card-header>

      <ion-card-content>
        <form [formGroup]="form" (ngSubmit)="login()">
          <!-- Email -->
          <ion-list>
            <ion-item>
              <ion-icon name="mail-outline" slot="start"></ion-icon>
              <ion-input
                type="email"
                formControlName="email"
                placeholder="Enter your email"
              ></ion-input>
            </ion-item>
            @if (form.controls.email.invalid && (form.controls.email.dirty || form.controls.email.touched)) {
              <ion-text color="danger">
                @if (form.controls.email.errors?.['required']) {
                  <p style="font-size: 12px; margin: 8px 16px 0 16px;">Email is required.</p>
                } @else if (form.controls.email.errors?.['email']) {
                  <p style="font-size: 12px; margin: 8px 16px 0 16px;">Please enter a valid email address.</p>
                }
              </ion-text>
            }
          </ion-list>

          <!-- Password -->
          @let passwordVisibleSig = passwordVisible();

          <ion-list>
            <ion-item>
              <ion-icon name="lock-closed-outline" slot="start"></ion-icon>
              <ion-input
                [type]="passwordVisibleSig ? 'text' : 'password'"
                formControlName="password"
                placeholder="Enter your password"
              ></ion-input>
              <ion-icon
                [name]="passwordVisibleSig ? 'eye-off-outline' : 'eye-outline'"
                slot="end"
                (click)="togglePassword()"
                style="cursor: pointer;"
              ></ion-icon>
            </ion-item>
            @if (form.controls.password.invalid && (form.controls.password.dirty || form.controls.password.touched)) {
              <ion-text color="danger">
                @if (form.controls.password.errors?.['required']) {
                  <p style="font-size: 12px; margin: 8px 16px 0 16px;">Password is required.</p>
                } @else if (form.controls.password.errors?.['minlength']) {
                  <p style="font-size: 12px; margin: 8px 16px 0 16px;">Password must be at least 6 characters long.</p>
                }
              </ion-text>
            }
          </ion-list>

          <!-- Remember Me -->
          <ion-item lines="none">
            <ion-checkbox formControlName="remember"></ion-checkbox>
            <ion-label>Remember me</ion-label>
          </ion-item>

          <!-- Forgot Password Link -->
          <div style="text-align: right; margin: 16px 0;">
            <ion-text>
              <a href="#" style="text-decoration: none; color: var(--ion-color-primary);">Forgot Password?</a>
            </ion-text>
          </div>

          <!-- Error Alert -->
          @if (errorMessage()) {
            <ion-alert
              [isOpen]="!!errorMessage()"
              header="Login Error"
              [message]="errorMessage() || ''"
              [buttons]="['OK']"
              (didDismiss)="errorMessage.set(null)"
            ></ion-alert>
          }

          <!-- Submit Button -->
          <ion-button
            expand="block"
            type="submit"
            [disabled]="form.invalid || isSigningIn()"
            color="primary"
          >
            @if (isSigningIn()) {
              <ion-spinner name="dots" slot="start"></ion-spinner>
              Signing in...
            } @else {
              <ion-icon name="log-in-outline" slot="start"></ion-icon>
              Login
            }
          </ion-button>
        </form>
      </ion-card-content>
    </ion-card>
  </div>

</ion-content>
